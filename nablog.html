<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog | ChargePower Inc</title>
    <link rel="icon" type="image/svg+xml" href="Assets/Logo/CP_Icon.svg">
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="index.html">
                    <img src="Assets/Logo/CP_Master_V3-dark.svg" alt="Chargepower Logo" class="cp-logo" />
                </a>
                <span class="region-label">- North America</span>
            </div>
            <div class="nav-menu">
                <a href="nahome.html" class="nav-link">Home</a>
                <a href="naprojects.html" class="nav-link">Projects</a>
                <a href="naabout.html" class="nav-link">About</a>
                <a href="nablog.html" class="nav-link active">Blog</a>
                <a href="nacareers.html" class="nav-link">Careers</a>
                <a href="naContact.html" class="nav-link">Contact</a>
            </div>
            <div class="nav-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="contact-hero" style="background: radial-gradient(circle at 30% 20%, rgba(22, 41, 244, 0.1) 0%, transparent 50%), radial-gradient(circle at 70% 80%, rgba(4, 254, 1, 0.1) 0%, transparent 50%);">
        <div class="container">
            <div class="hero-content">
                <h1 class="hero-title">Blog & Updates</h1>
                <p class="hero-subtitle">Stay up to date with our latest announcements, case studies, and articles.</p>
            </div>
        </div>
    </section>

    <!-- News Section -->
    <section class="news-section" style="padding-top: 40px; padding-bottom: 40px;">
        <div class="container">
            <!-- News Filters -->
            <div class="projects-filters" id="newsFilters" style="margin-bottom:2.5rem;">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="news">News</button>
                <button class="filter-btn" data-filter="case-studies">Case Studies</button>
                <button class="filter-btn" data-filter="articles">Articles</button>
            </div>
            <div class="projects-grid" id="newsGrid">
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <!-- Social icons hidden as requested -->
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Charge Power Inc. All rights reserved.</p>
                <p>Designed & Developed by <a href="http://www.ardnepu.com" target="_blank" rel="noopener noreferrer" style="background: linear-gradient(90deg, #1e90ff 0%, #00c3ff 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; text-decoration: none;">ardnepu</a></p>
            </div>
        </div>
    </footer>

    <!-- Post Modal -->
    <div id="postModal" class="modal" style="display: none; position: fixed; z-index: 9999; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); justify-content: center; align-items: center;">
        <div id="modalContent" style="background: var(--card-bg); border-radius: 12px; padding: 2rem; max-width: 800px; width: 90%; max-height: 90vh; overflow-y: auto; position: relative;">
            <!-- Modal content will be inserted here -->
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    <script>
        // Load posts from Supabase
        async function loadPostsFromSupabase() {
            try {
                const { data: posts, error } = await supabase
                    .from('posts')
                    .select('*')
                    .order('created_at', { ascending: false });
                
                if (error) {
                    console.error('Error loading posts:', error);
                    return;
                }
                
                const postsContainer = document.querySelector('.projects-grid');
                postsContainer.innerHTML = '';
                
                if (!posts || posts.length === 0) {
                    postsContainer.innerHTML = '<p style="text-align:center;color:var(--text-secondary);padding:2rem;">No blog posts found. Posts will appear here once created.</p>';
                    return;
                }
                
                // Create all post elements at once
                const postElements = posts.map((post, index) => {
                    const postTag = post.tag || 'news';
                    const postElement = document.createElement('div');
                    postElement.className = 'project-card news-post';
                    postElement.setAttribute('data-post', index);
                    postElement.setAttribute('data-type', postTag);
                    postElement.innerHTML = `
                        <span class="news-tag">${postTag.charAt(0).toUpperCase() + postTag.slice(1).replace('-', ' ')}</span>
                        <img src="${post.image_url}" alt="${post.title}" style="width:100%;height:225px;object-fit:cover;border-radius:12px 12px 0 0;">
                        <div class="project-header" style="margin-bottom:0;">
                            <div>
                                <h3 style="margin-bottom:0.3rem;">${post.title}</h3>
                                <span class="news-date">Created: ${new Date(post.created_at).toLocaleDateString()}${post.updated_at ? ' • Updated: ' + new Date(post.updated_at).toLocaleDateString() : ''}</span>
                            </div>
                        </div>
                        <br>
                        <button class="btn btn-primary read-btn" data-post="${index}">Read</button>
                    `;
                    return postElement;
                });
                
                // Append all elements at once
                postsContainer.append(...postElements);
                
                // Update newsPosts array for modal functionality
                window.newsPosts = posts.map(post => ({
                    title: post.title,
                    created_at: post.created_at,
                    updated_at: post.updated_at,
                    image: post.image_url,
                    content: post.content
                }));
                
                // Attach event listeners
                attachModalListeners();
            } catch (error) {
                console.error('Error in loadPostsFromSupabase:', error);
            }
        }
        
        // Attach modal event listeners
        function attachModalListeners() {
            document.querySelectorAll('.read-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const postIndex = this.getAttribute('data-post');
                    const post = window.newsPosts[postIndex];
                    if (post) {
                        showPostModal(post);
                    }
                });
            });
        }
        
        // Show post modal
        function showPostModal(post) {
            const modal = document.getElementById('postModal');
            const modalContent = document.getElementById('modalContent');
            
            modalContent.innerHTML = `
                <div style="position:relative;">
                    <button onclick="closeModal()" style="position:absolute;top:0;right:0;background:none;border:none;font-size:2rem;cursor:pointer;color:var(--text-primary);">&times;</button>
                    <h2 style="margin-bottom:1rem;color:var(--text-primary);">${post.title}</h2>
                    <p style="color:var(--text-secondary);margin-bottom:1.5rem;font-size:0.9rem;">
                        Created: ${new Date(post.created_at).toLocaleDateString()}
                        ${post.updated_at ? ' • Updated: ' + new Date(post.updated_at).toLocaleDateString() : ''}
                    </p>
                    <img src="${post.image}" alt="${post.title}" style="width:100%;max-height:300px;object-fit:cover;border-radius:8px;margin-bottom:1rem;">
                    <div style="color:var(--text-primary);line-height:1.6;">${post.content}</div>
                </div>
            `;
            
            modal.style.display = 'flex';
        }
        
        // Close modal
        function closeModal() {
            document.getElementById('postModal').style.display = 'none';
        }
        
        // Close modal when clicking outside
        document.getElementById('postModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
        
        // Load posts when page loads
        document.addEventListener('DOMContentLoaded', loadPostsFromSupabase);
        
        // Mobile menu toggle
        const navToggle = document.querySelector('.nav-toggle');
        const navMenu = document.querySelector('.nav-menu');
        
        navToggle.addEventListener('click', () => {
            navMenu.classList.toggle('active');
            navToggle.classList.toggle('active');
        });
        
        // Close mobile menu when clicking on a nav link
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', () => {
                navMenu.classList.remove('active');
                navToggle.classList.remove('active');
            });
        });
        
        // News filter logic
        const newsFilterBtns = document.querySelectorAll('#newsFilters .filter-btn');
        
        newsFilterBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                newsFilterBtns.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                const filter = this.getAttribute('data-filter');
                
                const newsPostsGridItems = document.querySelectorAll('.news-post');
                newsPostsGridItems.forEach(post => {
                    if (filter === 'all' || post.getAttribute('data-type') === filter) {
                        post.style.display = 'block';
                    } else {
                        post.style.display = 'none';
                    }
                });
            });
        });
    </script>
</body>
</html> 